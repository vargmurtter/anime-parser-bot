# Тестовое задание в SDK
Задача: 
- Спарсить данные с какого-нибудь сайта
- Реализовать телеграм-бота вокруг полученных данных

В качестве цели для парсинга был выбран сайт https://anidb.net/. Сайт с большой базой аниме, манги и прочего связанного контента. Решил сфокусироваться только на **аниме** и сделать бота, который позволяет вести списки просматриваемого аниме. 
На многих аниме-сайтах реализован функционал со списками тех тайтлов, которые пользователь смотрит, уже просмотрел или только планирует посмотреть. Такую механику я и реализовал.

P.S.
Вообще у сайта есть открытый API, но для ТЗ я написал именно парсер. 

P.S.S.
Я немного отошел от заданного ТЗ, реализовал клавиатуры, удобный inline-поиск и прочие приятности, но все заданные команды также реализованы.

## Стэк
- Python
- Aiogram 
- BeautifulSoup4
- Postgres
- Redis

## Структура проекта
```bash
.                         # корень проекта
├── app                   # папка с кодом бота
│   ├── extras            # папка с дополнительными либами, файлами, классами
│   ├── handlers          # хэндлеры - тут обрабатываются все действия юзера
│   ├── enums.py          # енумы
│   ├── keyboards.py      # клавиатуры
│   ├── models.py         # модели данных
│   ├── states.py         # состояния в боте
│   └── utils.py          # утилиты
├── migrations            # миграции
├── logs                  # логи (папка генерируется после первого запуска бота)
├── .env.example          # пример того как заполнять .env 
├── config.py             # конфиг
├── loaders.py            # файлик с инстансами важных компонентов
├── main.py               # пустовой файл
├── parser.py             # парсер
├── pyproject.toml        # настройки пайтон проекта
├── README.md             # вы здесь :)
└── requirements.txt      # зависимости
```

## Как создать бота
1. Открываем https://t.me/BotFather в телеграме
2. `/newbot`
3. Вводим название бота
4. Вводим никнейм бота
5. Получаем бот-токен вида `74186XXXXX:AAF4UXXXXXXXXXXXXXXXXXXXXDzikCMzvpk`
6. Получаем ссылку на бота
7. `/mybots` > выбираем нашего бота > Bot Settings > Inline Mode > Turn On

## Как развернуть проект
На сервере необходимо иметь:
- Python 3.11.X
- Postgres (проще всего спуллить докер контейнер)
- Redis (также спуллить с докерхаба или `sudo apt install redis`)
- Убедиться в том, что все сервисы работают

Настройка (из корня проекта):
1. `python3.11 -m venv venv`
2. `source venv/bin/activate`
3. `pip install -r requirements.txt` ! если ругается на либу asyncpg, то делаем так: `sudo apt install python3-dev` и повторяем установку !
4. `cp .env.example .env`
5. `nano .env`
6. заполнить `.env` файл по примеру
7. создать базу данных в postgres с тем именем, которое указали в .env (https://www.commandprompt.com/education/how-to-create-a-postgresql-database-in-docker/)
8. `aerich upgrade`
9. `python parser.py` - спарсит данные с сайта в БД, займет несколько минут
10. `python main.py` - запустит бота

